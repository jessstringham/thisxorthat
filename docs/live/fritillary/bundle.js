(()=>{"use strict";var t={256:(t,e,n)=>{t.exports=n.p+"47afb432e860b2e44ad1.wasm"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}let r;n.m=t,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href;const o=new Array(128).fill(void 0);function i(t){return o[t]}o.push(void 0,null,!0,!1);let a=o.length;function s(t){a===o.length&&o.push(o.length+1);const e=a;if(a=o[e],"number"!=typeof a)throw new Error("corrupt heap");return o[e]=t,e}function c(t,e){try{return t.apply(this,e)}catch(t){r.__wbindgen_exn_store(s(t))}}function l(t,e){try{return t.apply(this,e)}catch(t){let e=function(){try{return t instanceof Error?`${t.message}\n\nStack:\n${t.stack}`:t.toString()}catch(t){return"<failed to stringify thrown value>"}}();throw console.error("wasm-bindgen: imported JS function that was not marked as `catch` threw an error:",e),t}}const d="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&d.decode();let u=null;function _(){return null!==u&&0!==u.byteLength||(u=new Uint8Array(r.memory.buffer)),u}function w(t,e){return t>>>=0,d.decode(_().subarray(t,t+e))}let f=0;const g="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},m="function"==typeof g.encodeInto?function(t,e){return g.encodeInto(t,e)}:function(t,e){const n=g.encode(t);return e.set(n),{read:t.length,written:n.length}};function p(t,e,n){if("string"!=typeof t)throw new Error("expected a string argument, found "+typeof t);if(void 0===n){const n=g.encode(t),r=e(n.length,1)>>>0;return _().subarray(r,r+n.length).set(n),f=n.length,r}let r=t.length,o=e(r,1)>>>0;const i=_();let a=0;for(;a<r;a++){const e=t.charCodeAt(a);if(e>127)break;i[o+a]=e}if(a!==r){0!==a&&(t=t.slice(a)),o=n(o,r,r=a+3*t.length,1)>>>0;const e=_().subarray(o+a,o+r),i=m(t,e);if(i.read!==t.length)throw new Error("failed to pass whole string");a+=i.written,o=n(o,r,a,1)>>>0}return f=a,o}let b=null;function h(){return(null===b||!0===b.buffer.detached||void 0===b.buffer.detached&&b.buffer!==r.memory.buffer)&&(b=new DataView(r.memory.buffer)),b}function y(t){return null==t}function v(t){const e=i(t);return function(t){t<132||(o[t]=a,a=t)}(t),e}function E(t){if("boolean"!=typeof t)throw new Error("expected a boolean argument, found "+typeof t)}const x="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>{r.__wbindgen_export_4.get(t.dtor)(t.a,t.b)}));function L(t){const e=typeof t;if("number"==e||"boolean"==e||null==t)return`${t}`;if("string"==e)return`"${t}"`;if("symbol"==e){const e=t.description;return null==e?"Symbol":`Symbol(${e})`}if("function"==e){const e=t.name;return"string"==typeof e&&e.length>0?`Function(${e})`:"Function"}if(Array.isArray(t)){const e=t.length;let n="[";e>0&&(n+=L(t[0]));for(let r=1;r<e;r++)n+=", "+L(t[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(!(n&&n.length>1))return toString.call(t);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(t)+")"}catch(t){return"Object"}return t instanceof Error?`${t.name}: ${t.message}\n${t.stack}`:r}function A(){return v(r.rn_count())}let S=null;function M(t){const e=function(t,e){const n=e(4*t.length,4)>>>0;return(null!==S&&0!==S.byteLength||(S=new Float32Array(r.memory.buffer)),S).set(t,n/4),f=t.length,n}(t,r.__wbindgen_malloc),n=f;return v(r.gen_from_rn(e,n))}function k(t){if("number"!=typeof t)throw new Error("expected a number argument, found "+typeof t)}function C(t,e){t>>>=0;const n=h(),r=[];for(let o=t;o<t+4*e;o+=4)r.push(v(n.getUint32(o,!0)));return r}function I(t,e,n){k(t),k(e),r._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h532a6080c5d0b46e(t,e,s(n))}const R="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>r.__wbg_murreletmodel_free(t>>>0,1)));class T{static __wrap(t){t>>>=0;const e=Object.create(T.prototype);return e.__wbg_ptr=t,R.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,R.unregister(this),t}free(){const t=this.__destroy_into_raw();r.__wbg_murreletmodel_free(t,0)}constructor(t){const e=p(t,r.__wbindgen_malloc,r.__wbindgen_realloc),n=f;return v(r.murreletmodel_new(e,n))}update_config(t){let e,n;try{if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");const a=r.__wbindgen_add_to_stack_pointer(-16);k(this.__wbg_ptr);const s=p(t,r.__wbindgen_malloc,r.__wbindgen_realloc),c=f;r.murreletmodel_update_config(a,this.__wbg_ptr,s,c);var o=h().getInt32(a+0,!0),i=h().getInt32(a+4,!0);return e=o,n=i,w(o,i)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(e,n,1)}}update_frame(t,e,n,o,i,a){if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");k(this.__wbg_ptr),function(t){if("bigint"!=typeof t)throw new Error("expected a bigint argument, found "+typeof t)}(t),E(a),r.murreletmodel_update_frame(this.__wbg_ptr,t,e,n,o,i,a)}canvas_ids(){try{if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");const o=r.__wbindgen_add_to_stack_pointer(-16);k(this.__wbg_ptr),r.murreletmodel_canvas_ids(o,this.__wbg_ptr);var t=h().getInt32(o+0,!0),e=h().getInt32(o+4,!0),n=C(t,e).slice();return r.__wbindgen_free(t,4*e,4),n}finally{r.__wbindgen_add_to_stack_pointer(16)}}make_img_defs(){let t,e;try{if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");const i=r.__wbindgen_add_to_stack_pointer(-16);k(this.__wbg_ptr),r.murreletmodel_make_img_defs(i,this.__wbg_ptr);var n=h().getInt32(i+0,!0),o=h().getInt32(i+4,!0);return t=n,e=o,w(n,o)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(t,e,1)}}draw_err(){let t,e;try{if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");const i=r.__wbindgen_add_to_stack_pointer(-16);k(this.__wbg_ptr),r.murreletmodel_draw_err(i,this.__wbg_ptr);var n=h().getInt32(i+0,!0),o=h().getInt32(i+4,!0);return t=n,e=o,w(n,o)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(t,e,1)}}draw(){try{if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");const o=r.__wbindgen_add_to_stack_pointer(-16);k(this.__wbg_ptr),r.murreletmodel_draw(o,this.__wbg_ptr);var t=h().getInt32(o+0,!0),e=h().getInt32(o+4,!0),n=C(t,e).slice();return r.__wbindgen_free(t,4*e,4),n}finally{r.__wbindgen_add_to_stack_pointer(16)}}fps(){if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");return k(this.__wbg_ptr),r.murreletmodel_fps(this.__wbg_ptr)}bg_color(){let t,e;try{if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");const i=r.__wbindgen_add_to_stack_pointer(-16);k(this.__wbg_ptr),r.murreletmodel_bg_color(i,this.__wbg_ptr);var n=h().getInt32(i+0,!0),o=h().getInt32(i+4,!0);return t=n,e=o,w(n,o)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(t,e,1)}}}const O="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((t=>r.__wbg_wasmmurreletmodelresult_free(t>>>0,1)));class F{constructor(){throw new Error("cannot invoke `new` directly")}static __wrap(t){t>>>=0;const e=Object.create(F.prototype);return e.__wbg_ptr=t,O.register(e,e.__wbg_ptr,e),e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,O.unregister(this),t}free(){const t=this.__destroy_into_raw();r.__wbg_wasmmurreletmodelresult_free(t,0)}is_err(){if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");return k(this.__wbg_ptr),0!==r.wasmmurreletmodelresult_is_err(this.__wbg_ptr)}err_msg(){let t,e;try{if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");const i=this.__destroy_into_raw(),a=r.__wbindgen_add_to_stack_pointer(-16);k(i),r.wasmmurreletmodelresult_err_msg(a,i);var n=h().getInt32(a+0,!0),o=h().getInt32(a+4,!0);return t=n,e=o,w(n,o)}finally{r.__wbindgen_add_to_stack_pointer(16),r.__wbindgen_free(t,e,1)}}to_model(){if(0==this.__wbg_ptr)throw new Error("Attempt to use a moved value");const t=this.__destroy_into_raw();k(t);const e=r.wasmmurreletmodelresult_to_model(t);return T.__wrap(e)}}function U(){const t={wbg:{}};return t.wbg.__wbg_call_672a4d21634d4a24=function(){return c((function(t,e){return s(i(t).call(i(e)))}),arguments)},t.wbg.__wbg_call_7cccdd69e0791ae2=function(){return c((function(t,e,n){return s(i(t).call(i(e),i(n)))}),arguments)},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(){return l((function(t,e){let n,o;try{n=t,o=e,console.error(w(t,e))}finally{r.__wbindgen_free(n,o,1)}}),arguments)},t.wbg.__wbg_new_23a2665fac83c611=function(){return l((function(t,e){try{var n={a:t,b:e};const o=new Promise(((t,e)=>{const o=n.a;n.a=0;try{return function(t,e,n,o){k(t),k(e),r.wasm_bindgen__convert__closures__invoke2_mut__hb75425aa2cc73394(t,e,s(n),s(o))}(o,n.b,t,e)}finally{n.a=o}}));return s(o)}finally{n.a=n.b=0}}),arguments)},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return l((function(){return s(new Error)}),arguments)},t.wbg.__wbg_newnoargs_105ed471475aaf50=function(){return l((function(t,e){return s(new Function(w(t,e)))}),arguments)},t.wbg.__wbg_now_0bab97e4f4650974=function(){return l((function(){return Date.now()}),arguments)},t.wbg.__wbg_queueMicrotask_97d92b4fcc8a61c5=function(){return l((function(t){queueMicrotask(i(t))}),arguments)},t.wbg.__wbg_queueMicrotask_d3219def82552485=function(){return l((function(t){return s(i(t).queueMicrotask)}),arguments)},t.wbg.__wbg_resolve_4851785c9c5f573d=function(){return l((function(t){return s(Promise.resolve(i(t)))}),arguments)},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(){return l((function(t,e){const n=p(i(e).stack,r.__wbindgen_malloc,r.__wbindgen_realloc),o=f;h().setInt32(t+4,o,!0),h().setInt32(t+0,n,!0)}),arguments)},t.wbg.__wbg_static_accessor_GLOBAL_88a902d13a557d07=function(){return l((function(){const t="undefined"==typeof global?null:global;return y(t)?0:s(t)}),arguments)},t.wbg.__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0=function(){return l((function(){const t="undefined"==typeof globalThis?null:globalThis;return y(t)?0:s(t)}),arguments)},t.wbg.__wbg_static_accessor_SELF_37c5d418e4bf5819=function(){return l((function(){const t="undefined"==typeof self?null:self;return y(t)?0:s(t)}),arguments)},t.wbg.__wbg_static_accessor_WINDOW_5de37043a91a9c40=function(){return l((function(){const t="undefined"==typeof window?null:window;return y(t)?0:s(t)}),arguments)},t.wbg.__wbg_then_44b73946d2fb3e7d=function(){return l((function(t,e){return s(i(t).then(i(e)))}),arguments)},t.wbg.__wbg_wasmmurreletmodelresult_new=function(){return l((function(t){return s(F.__wrap(t))}),arguments)},t.wbg.__wbindgen_cb_drop=function(t){const e=v(t).original;if(1==e.cnt--)return e.a=0,!0;const n=!1;return E(n),n},t.wbg.__wbindgen_closure_wrapper2963=function(){return l((function(t,e,n){const o=function(t,e,n,o){const i={a:t,b:e,cnt:1,dtor:140},a=(...t)=>{i.cnt++;const e=i.a;i.a=0;try{return o(e,i.b,...t)}finally{0==--i.cnt?(r.__wbindgen_export_4.get(i.dtor)(e,i.b),x.unregister(i)):i.a=e}};return a.original=i,x.register(a,i,i),a}(t,e,0,I);return s(o)}),arguments)},t.wbg.__wbindgen_debug_string=function(t,e){const n=p(L(i(e)),r.__wbindgen_malloc,r.__wbindgen_realloc),o=f;h().setInt32(t+4,o,!0),h().setInt32(t+0,n,!0)},t.wbg.__wbindgen_is_function=function(t){const e="function"==typeof i(t);return E(e),e},t.wbg.__wbindgen_is_undefined=function(t){const e=void 0===i(t);return E(e),e},t.wbg.__wbindgen_number_new=function(t){return s(t)},t.wbg.__wbindgen_object_clone_ref=function(t){return s(i(t))},t.wbg.__wbindgen_object_drop_ref=function(t){v(t)},t.wbg.__wbindgen_string_new=function(t,e){return s(w(t,e))},t.wbg.__wbindgen_throw=function(t,e){throw new Error(w(t,e))},t}async function j(t){if(void 0!==r)return r;void 0!==t&&(Object.getPrototypeOf(t)===Object.prototype?({module_or_path:t}=t):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===t&&(t=new URL(n(256),n.b));const e=U();("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:o,module:i}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"==t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}(await t,e);return function(t,e){return r=t.exports,j.__wbindgen_wasm_module=e,b=null,S=null,u=null,r}(o,i)}const W=j,q="http://www.w3.org/2000/svg",B=Math.pow(10,4);function D(t){let e=[];for(let r=0;r<t.length;r++)e.push((n=Math.round(t[r]*B)/B)>=1?(B-1)/B:n<0?0:n);var n;return e}function $(t){let e=[];for(let n=0;n<t.length;n++)e.push(String(Math.round(t[n]*B)).padStart(4,"0"));return e.join("-")}function P(t){let e=t.split("-"),n=[];for(let t=0;t<e.length;t++)n.push(parseInt(e[t])/B);return n}function N(){return P(new URLSearchParams(window.location.search).get("cubed"))}const z={time:{},ctx:""};class J{constructor(t){this.murrelet=null,this.svg=t,this.mouse_x=0,this.mouse_y=0,this.mouse_down=!1,this.dim_x=600,this.dim_y=600,this.frame=1n,this.fps=30,this.lastUpdate=performance.now()}async initModel(t){console.log("init model");try{let e=await function(t){const e=p(t,r.__wbindgen_malloc,r.__wbindgen_realloc),n=f;return v(r.new_model(e,n))}(t);e.is_err()?(console.log("ERROR",e.err_msg()),document.getElementById("err_msg").innerHTML=e.err_msg()):(this.murrelet=e.to_model(),console.log("model init"))}catch(t){console.error("init failed",t)}}paths(){return this.svg.getElementById("paths")}async reload(t){var e="";const n=JSON.stringify(t);return null===this.murrelet&&await this.initModel(n),null!==this.murrelet&&("Success!"==(e=this.murrelet.update_config(n))&&(e=this.murrelet.draw_err()),this.fps=this.murrelet.fps(),this.updateWindowSize()),e}updateMurreletWithWorld(){null!==this.murrelet&&this.murrelet.update_frame(this.frame,this.dim_x,this.dim_y,this.mouse_x,this.mouse_y,this.mouse_down)}updateWindowSize(){const t=this.svg.getBoundingClientRect();this.dim_x=t.width,this.dim_y=t.height}mouseMove(t){const e=this.svg.getBoundingClientRect();this.mouse_x=t.clientX-e.left,this.mouse_y=t.clientY-e.top}mouseDown(){this.mouseDown=!0}mouseUp(){this.mouseDown=!1}updateAndDraw(){if(null!==this.murrelet){const t=performance.now();{this.updateMurreletWithWorld();let e=this.murrelet.draw();this.paths().innerHTML=e[1],this.lastUpdate=t,this.bgColor=this.murrelet.bg_color(),this.svg.style.backgroundColor=this.bgColor}this.frame+=1n}}}async function H(t,e){const n=await M(e),r=JSON.parse(n),o={app:z,drawing:r};let i=await t.reload(o);return""!=i?(console.log(n),console.log(i),!1):(t.updateAndDraw(),!0)}function G(t=0,e=1){let n=0,r=0;for(;0===n;)n=Math.random();for(;0===r;)r=Math.random();return Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*r)*e+t}function X(t,e){const n=e.getElementById("paths"),r=n.getBBox(),o=400-(r.x+r.width/2),i=400-(r.y+r.height/2);n.setAttribute("transform",`translate(${o}, ${i})`),t.classList.add("visible")}function Y(t){let e=document.createElementNS(q,"svg");e.setAttribute("viewBox","0 0 800 800");let n=document.createElementNS(q,"g");return n.id="paths",e.appendChild(n),t.appendChild(e),e}async function V(t,e){let n;for(let r=0;r<30&&(n=Array.from({length:e},(()=>Math.random())),!await H(t,n));r++)console.log("trying again");return n}let K=!1;async function Q(t){if(K)return;K=!0;const e=document.body.clientWidth,n=Math.floor(e/201),r=Math.floor(500/174),o=Math.max(n*r,10),i=5*Math.floor(o/5);var a=new J;let s=await A(),c=0;for(let e=0;e<i;e++){let e;for(let n=0;n<5;n++){let r=document.createElement("div");r.classList.add("explore-example"),t.appendChild(r);const o=Y(r);let i;a.svg=o,0==n?(e=await V(a,s),i=e):(i=D(e.map((t=>t+G(0,.05)))),await H(a,i)||(console.log("invalid, starting over"),i=await V(a,s))),r.setAttribute("data-embedding",$(i)),r.addEventListener("click",(()=>{const t=new URL(window.location.href);t.searchParams.set("cubed",r.getAttribute("data-embedding")),window.location.href=t.toString(),history.pushState(null,"",t.toString())})),requestAnimationFrame((()=>{requestAnimationFrame((()=>{X(r,o)}))})),await new Promise((t=>setTimeout(t,10))),c+=1}}K=!1}async function Z(){let t=document.createElement("div");t.classList.add("container"),t.id="exploreContainer",document.body.appendChild(t);let e=document.createElement("div");e.classList.add("explore-flex"),t.appendChild(e);const n=function(t){let e=0;return function(...n){const r=Date.now();r-e>=100&&(e=r,t.apply(this,n))}}((()=>{t.scrollTop+t.clientHeight>=t.scrollHeight-300&&Q(e)}));t.addEventListener("scroll",n),Q(e)}function tt(t,e,n,r,o,i,a){let s=[];for(let c=0;c<t.length;c++)s.push(t[c]+o*e[c]+i*n[c]+a*r[c]);return D(s)}function et(t){let e=Array.from({length:t},(()=>Math.random()));const n=e.reduce(((t,e)=>t+e),0);return e.map((t=>t/n))}function nt(t,e){return t.map((t=>t*e))}let rt=30;const ot="silverspot-keyframes";async function it(t,e,n){if(K)return;K=!0;let r=n.length;const o=et(r),i=et(r),a=et(r);let s=nt(o,rt*r/100),c=nt(i,rt*r/100),l=nt(a,rt*r/100);for(let r=0;r<7;r++)for(let o=0;o<7;o++){let i=e[o][r];const a=i.getAttribute("data-qrs"),[d,u,_]=a.split(",").map(Number),w=0==d&&0==u&&0==_;if(Math.abs(d)>3||Math.abs(u)>3||Math.abs(_)>3);else{let e=tt(n,s,c,l,d/3,u/3,_/3),r=i.querySelectorAll("svg");const o=Y(i);o.classList.add("cube-row-box-wrapper"),t.svg=o,await H(t,e),w&&(document.body.style.backgroundColor=t.bgColor),i.setAttribute("data-embedding",$(e)),r&&setTimeout((()=>{r.forEach((t=>{t.remove()}))}),1e3),requestAnimationFrame((()=>{requestAnimationFrame((()=>{X(i,o)}))})),await new Promise((t=>setTimeout(t,1))),o.offsetWidth,o.classList.add("fade-in")}}K=!1}async function at(t){return await async function(t){const e=(new TextEncoder).encode($(t)),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map((t=>t.toString(16).padStart(2,"0"))).join("").slice(0,12)}(t)}async function st(t,e,n){const r=document.createElement("canvas");r.width=224,r.height=224;const o=r.getContext("2d"),i=(new XMLSerializer).serializeToString(t),a=new Blob([i],{type:"image/svg+xml;charset=utf-8"}),s=URL.createObjectURL(a);return new Promise((t=>{const i=new Image;i.onload=()=>{o.drawImage(i,0,0),URL.revokeObjectURL(s);const a=JSON.stringify({vectors:e});r.toBlob((e=>{const r=new File([e],n,{type:"image/png"}),o=new FormData;o.append("file",r),o.append("metadata",a);const i=document.createElement("a");i.href=URL.createObjectURL(e),i.download=n,document.body.appendChild(i),i.click(),document.body.removeChild(i),t()}),"image/png")},i.src=s}))}!async function(){await W();const t=new URLSearchParams(window.location.search);if(t.has("perterb")){const e=t.get("cubed"),n=t.get("perterb"),r=t.get("idx");await async function(t,e,n){const r=P(t),o=document.createElement("select");o.id="default-select",document.body.appendChild(o);const i=document.createElement("select");i.id="indexSelect",document.body.appendChild(i);let a=n;n||(a=Math.floor(Math.random()*r.length));let s=document.createElement("pre");s.innerText=a+"\n",document.body.appendChild(s);let c=document.createElement("div"),l=document.createElement("div");l.addEventListener("input",(async()=>{scrollBox.innerText=l.value,rt=l.value;let t=N();await it(_,divs,t)})),document.body.appendChild(c);let d=document.createElement("div");d.classList.add("container"),document.body.appendChild(d);let u=document.createElement("div");u.classList.add("perterb-row-doc"),d.appendChild(u);var _=new J;Array(r.length).fill(0)[a]=parseFloat(e);for(let t=0;t<5;t++){let e=r.map((t=>t));e[a]=t/4;let n=document.createElement("div");n.classList.add("perterb-container"),u.appendChild(n),2==t&&n.classList.add("perterb-center"),n.setAttribute("data-embedding",$(r)),n.addEventListener("mouseover",(async()=>{let t=await M(e);w.innerHTML=JSON.stringify(JSON.parse(t),null,"\t")}));const o=Y(n);_.svg=o,await H(_,e),requestAnimationFrame((()=>{requestAnimationFrame((()=>{X(n,o)}))}))}let w=document.createElement("pre");w.classList.add("perterb-row-doc"),d.appendChild(w);const f=r.length;for(let t=0;t<f;t++){let e=document.createElement("option");e.value=t,e.textContent=t,i.appendChild(e)}const g=new URLSearchParams(window.location.search).get("idx");null!==g&&(i.value=g),i.addEventListener("change",(function(){const t=i.value,e=new URL(window.location.href);e.searchParams.set("idx",t),window.location.href=e.toString()}));let m=await M(r);w.innerHTML=JSON.stringify(JSON.parse(m),null,"\t")}(e,n,r)}else if(t.has("cubed")){const e=t.get("cubed"),[n,r,o]=await async function(t){let e=document.createElement("div");e.classList.add("cube-row-doc"),document.body.appendChild(e);let n=document.createElement("div");n.classList.add("cube-holder"),e.appendChild(n);const r=document.createElement("a"),o=window.location.origin+window.location.pathname.split("/").slice(0,-1).join("/");r.href=o,r.innerText="← Back",r.classList.add("back-button"),document.body.appendChild(r);const i=document.createElement("div");i.classList.add("slider-container");const a=document.createElement("input");a.type="range",a.min="1",a.max="100",a.value=rt,a.classList.add("scroll-slider");const s=document.createElement("div");s.classList.add("scroll-box"),s.innerText=rt,i.appendChild(s),i.appendChild(a),document.body.appendChild(i),a.addEventListener("input",(async()=>{s.innerText=a.value,rt=a.value;let t=N();await it(l,d,t)}));const c=P(t);var l=new J;const d=function(t,e){let n=document.createElement("div");n.classList.add("dark-overlay"),document.body.appendChild(n);let r=[];for(let e=0;e<7;e++){let n=document.createElement("div");n.classList.add("cube-row-container"),n.style.height="180px",n.style.width="1260px",t.appendChild(n);let o=[];for(let t=0;t<7;t++){let r=document.createElement("div");r.classList.add("cube-row-box"),r.style.height="180px",n.appendChild(r);let i=t-3,a=e-3;t%2==0&&(r.style.transform="translateY(90px)");let s=i,c=a-Math.floor(s/2),l=-s-c;r.setAttribute("data-qrs",`${s},${c},${l}`),o.push(r)}r.push(o)}for(let t=0;t<7;t++)for(let n=0;n<7;n++){const o=r[t][n],i=o.getAttribute("data-qrs"),[a,s,c]=i.split(",").map(Number);Math.abs(a)>3||Math.abs(s)>3||Math.abs(c)>3||(o.addEventListener("click",(()=>{let t=o.getAttribute("data-embedding");const n=new URL(window.location.href);n.searchParams.set("cubed",t),history.pushState(null,"",n.toString()),it(e,r,P(t))})),o.addEventListener("contextmenu",(t=>{t.preventDefault();let e=o.getAttribute("data-embedding"),n=localStorage.getItem(ot),r=[];for(n&&(r=n.split(",")),r.push(e);r.length>30;)r.shift();console.log(r.length,"items"),localStorage.setItem(ot,r.join(","))})))}return r}(n,l);return[l,d,c]}(e);await it(n,r,o)}else t.has("download")?await async function(){var t=new J(document.getElementById("frame"));const e=document.createElement("div");document.body.appendChild(e);let n=await A();const r=Y(e);t.svg=r;for(let o=0;o<120;o++){const o=await V(t,n);await H(t,o),X(e,r),r&&st(r,o,`${await at(o)}.png`)}}():t.has("playback")?await async function(){let t=(localStorage.getItem(ot)||"").split(",").map((t=>P(t)));const e=document.createElement("div");e.classList.add("animate-box"),document.body.appendChild(e);let n=0,r=Date.now();var o=new J(document.getElementById("frame"));!async function i(){if(Date.now()-r>60){let i=function(t,e,n){let r=[];for(let o=0;o<t.length;o++)r.push((1-n)*t[o]+n*e[o]);return r}(t[Math.floor(n/50)%t.length],t[(Math.floor(n/50)+1)%t.length],n%50/50),a=e.querySelectorAll("svg");await A();const s=Y(e);o.svg=s,s.classList.add("animate-box"),await H(o,i),X(e,s),await new Promise((t=>setTimeout(t,1))),s.offsetWidth,s.classList.add("visible"),a&&setTimeout((()=>{a.forEach((t=>{t.remove()}))}),500),n+=1,r=Date.now()}requestAnimationFrame(i)}()}():await Z()}()})();